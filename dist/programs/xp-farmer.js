export async function main(ns) {
    ns.tail();
    ns.disableLog('ALL');
    const script = '/programs/dependencies/1weaken.js';
    const target = 'joesguns';
    let servers = ns.getPurchasedServers();
    for (let server of servers) {
        ns.killall(server);
        await ns.scp(script, 'home', server);
    }
    servers.push('home');
    servers = servers.sort(function (a, b) {
        if (a == 'home')
            return 1;
        const aN = parseInt(a.replace(/S0|S/gm, ''), 10);
        const bN = parseInt(b.replace(/S0|S/gm, ''), 10);
        return aN - bN;
    });
    ns.clearLog();
    while (true) {
        let prnt = '';
        let allThreads = 0;
        for (let server of servers) {
            const threads = Math.floor((ns.getServerMaxRam(server) - ns.getServerUsedRam(server)) / ns.getScriptRam(script));
            if (threads > 0) {
                allThreads += threads;
                ns.exec(script, server, threads, target);
                prnt += (`\n${(server + ':').padEnd(5, ' ')} ${formatNumber(threads)} threads`);
            }
        }
        if (allThreads > 0) {
            prnt += `\nALL:  ${formatNumber(allThreads)} threads`;
            ns.clearLog();
            ns.print(prnt);
        }
        await ns.sleep(1000);
    }
    function formatNumber(num) {
        if (num >= 10 ** 12) {
            return ((num / 10 ** 12).toFixed(2) + 'q').padStart(7, ' ');
        }
        if (num >= 10 ** 9) {
            return ((num / 10 ** 9).toFixed(2) + 't').padStart(7, ' ');
        }
        if (num >= 10 ** 6) {
            return ((num / 10 ** 6).toFixed(2) + 'm').padStart(7, ' ');
        }
        if (num >= 10 ** 3) {
            return ((num / 10 ** 3).toFixed(2) + 'k').padStart(7, ' ');
        }
        return ((num).toFixed(0) + '').padStart(7, ' ');
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieHAtZmFybWVyLmpzIiwic291cmNlUm9vdCI6Imh0dHA6Ly9sb2NhbGhvc3Q6ODAwMC9zb3VyY2VzLyIsInNvdXJjZXMiOlsicHJvZ3JhbXMveHAtZmFybWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE1BQU0sQ0FBQyxLQUFLLFVBQVUsSUFBSSxDQUFDLEVBQU87SUFDOUIsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFBO0lBQ1QsRUFBRSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUVwQixNQUFNLE1BQU0sR0FBRyxtQ0FBbUMsQ0FBQTtJQUNsRCxNQUFNLE1BQU0sR0FBRyxVQUFVLENBQUE7SUFDekIsSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDLG1CQUFtQixFQUFFLENBQUE7SUFFdEMsS0FBSyxJQUFJLE1BQU0sSUFBSSxPQUFPLEVBQUU7UUFDeEIsRUFBRSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUNsQixNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFDLE1BQU0sRUFBQyxNQUFNLENBQUMsQ0FBQTtLQUNyQztJQUVELE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUE7SUFFcEIsT0FBTyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUMsQ0FBQztRQUNoQyxJQUFJLENBQUMsSUFBSSxNQUFNO1lBQUUsT0FBTyxDQUFDLENBQUE7UUFDekIsTUFBTSxFQUFFLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFDLEVBQUUsQ0FBQyxFQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQzlDLE1BQU0sRUFBRSxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBQyxFQUFFLENBQUMsRUFBQyxFQUFFLENBQUMsQ0FBQTtRQUM5QyxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUE7SUFDbEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUE7SUFFYixPQUFPLElBQUksRUFBRTtRQUNULElBQUksSUFBSSxHQUFHLEVBQUUsQ0FBQTtRQUNiLElBQUksVUFBVSxHQUFHLENBQUMsQ0FBQTtRQUNsQixLQUFLLElBQUksTUFBTSxJQUFJLE9BQU8sRUFBRTtZQUN4QixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUE7WUFDaEgsSUFBSSxPQUFPLEdBQUcsQ0FBQyxFQUFFO2dCQUNiLFVBQVUsSUFBSSxPQUFPLENBQUE7Z0JBQ3JCLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFDLE1BQU0sRUFBQyxPQUFPLEVBQUMsTUFBTSxDQUFDLENBQUE7Z0JBQ3JDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBQyxHQUFHLENBQUMsSUFBSSxZQUFZLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFBO2FBQ2pGO1NBQ0o7UUFDRCxJQUFJLFVBQVUsR0FBRyxDQUFDLEVBQUU7WUFDaEIsSUFBSSxJQUFJLFdBQVcsWUFBWSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUE7WUFDckQsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFBO1lBQ2IsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtTQUNqQjtRQUNELE1BQU0sRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtLQUN2QjtJQUVELFNBQVMsWUFBWSxDQUFFLEdBQVk7UUFDL0IsSUFBSSxHQUFHLElBQUksRUFBRSxJQUFFLEVBQUUsRUFBRTtZQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsR0FBRyxFQUFFLElBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUMsR0FBRyxDQUFDLENBQUE7U0FBQztRQUM3RSxJQUFJLEdBQUcsSUFBSSxFQUFFLElBQUUsQ0FBQyxFQUFFO1lBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxHQUFHLEVBQUUsSUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBQyxHQUFHLENBQUMsQ0FBQTtTQUFDO1FBQzNFLElBQUksR0FBRyxJQUFJLEVBQUUsSUFBRSxDQUFDLEVBQUU7WUFBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEdBQUcsRUFBRSxJQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFDLEdBQUcsQ0FBQyxDQUFBO1NBQUM7UUFDM0UsSUFBSSxHQUFHLElBQUksRUFBRSxJQUFFLENBQUMsRUFBRTtZQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsR0FBRyxFQUFFLElBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUMsR0FBRyxDQUFDLENBQUE7U0FBQztRQUMzRSxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBQyxHQUFHLENBQUMsQ0FBQTtJQUNsRCxDQUFDO0FBRUwsQ0FBQyJ9